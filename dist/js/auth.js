document.addEventListener("DOMContentLoaded",(()=>{const e=document.getElementById("login-form"),t=document.getElementById("register-form");e.addEventListener("submit",(async t=>{t.preventDefault();const o=e.querySelector('input[type="text"]').value,n=e.querySelector('input[type="password"]').value;try{const e=await fetch("/api/users/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,password:n})});if(e.ok){const t=await e.json();localStorage.setItem("token",t.token),window.location.href="/home.html"}else alert("登录失败,请检查用户名和密码")}catch(e){console.error("登录错误:",e),alert("登录过程中发生错误")}})),t.addEventListener("submit",(async e=>{e.preventDefault();const o=t.querySelector('input[type="text"]').value,n=t.querySelector('input[type="email"]').value,r=t.querySelector('input[type="password"]').value;try{(await fetch("/api/users/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o,email:n,password:r})})).ok?(alert("注册成功!请登录"),window.location.href="/login.html"):alert("注册失败,请稍后再试")}catch(e){console.error("注册错误:",e),alert("注册过程中发生错误")}}))}));